{"version":3,"sources":["components/Spinner/index.js","components/Loading/index.js","components/Result/index.js","App.js","reportWebVitals.js","index.js"],"names":["Spinner","props","className","children","Loading","parseCsv","csv","csvtojson","noheader","output","fromString","renderRow","row","search","filter","Boolean","map","word","index","split","segment","arr","length","Fragment","Result","spreadsheetData","inputRef","useRef","useState","loading","setLoading","showIntro","setShowIntro","placeholderHeight","setPlaceholderHeight","searchHistory","setSearchHistory","searchResult","setSearchResult","setSearch","now","setNow","wordOfDay","setWordOfDay","pushSearchHistory","useCallback","key","value","prevSearchHistory","onSearchChange","event","target","generalSearch","keyword","line","includes","historySearch","useMemo","searchHistoryWords","Object","keys","hasOwnProperty","potentialMatchKeyword","find","results","keywordSearch","historySearchedRows","Array","isArray","useEffect","timeoutId","window","setTimeout","trim","result","join","then","clearTimeout","el","current","Element","getBoundingClientRect","height","Date","todayDiff","Math","floor","ref","onChange","placeholder","style","getFullYear","getMonth","getDate","href","slice","App","setSpreadsheetData","fetch","response","text","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qOAGe,SAASA,EAASC,GAC7B,OACE,sBAAKC,UAAU,UAAf,UACE,qBAAKA,UAAU,qBACdD,EAAME,SAAW,qBAAKD,UAAU,gBAAf,SAAgCD,EAAME,WAAkB,MCJnE,SAASC,IACtB,OACE,qBAAKF,UAAU,UAAf,SACE,eAACF,EAAD,wBAAmB,uBAAnB,6B,kCCGN,SAASK,EAAUC,GACf,OAAOC,IAAU,CAACC,UAAU,EAAMC,OAAQ,QAAQC,WAAWJ,GAGjE,SAASK,EAAWC,GAAqB,IAAhBC,EAAe,uDAAN,KAChC,OAAOD,EAAIE,OAAOC,SAASC,KAAI,SAACC,EAAMC,GACpC,IAAMT,EAASQ,EAAKE,MAAMN,GAAQG,KAAI,SAACI,EAASF,EAAOG,GACrD,OAAIA,EAAIC,OAAS,IAAMJ,EAAgBE,EAChC,eAAC,IAAMG,SAAP,WAA6BH,EAAQ,qBAAKlB,UAAU,oBAAf,SAAoCW,MAApDK,MAE9B,OAAc,IAAVA,EAAuB,sBAAkBhB,UAAU,qCAA5B,SAAkEO,GAAvDS,GAC9B,sBAAiBhB,UAAU,oCAA3B,UAAgEgB,EAAhE,KAAyET,IAA/DS,MAIP,SAASM,EAAQvB,GAAQ,IAC/BwB,EAAmBxB,EAAnBwB,gBACDC,EAAWC,mBAFoB,EAGPC,oBAAS,GAHF,mBAG9BC,EAH8B,KAGrBC,EAHqB,OAIHF,oBAAS,GAJN,mBAI9BG,EAJ8B,KAInBC,EAJmB,OAKaJ,mBAAS,GALtB,mBAK9BK,EAL8B,KAKXC,EALW,OAMKN,mBAAS,IANd,mBAM9BO,EAN8B,KAMfC,EANe,OAOGR,mBAAS,MAPZ,mBAO9BS,EAP8B,KAOhBC,EAPgB,OAQTV,mBAAS,IARA,mBAQ9Bf,EAR8B,KAQtB0B,EARsB,OASfX,mBAAS,MATM,mBAS9BY,EAT8B,KASzBC,EATyB,OAUHb,mBAAS,MAVN,mBAU9Bc,EAV8B,KAUnBC,EAVmB,KAW/BC,EAAoBC,uBAAY,SAACC,EAAKC,GAAN,OAAgBX,GAAiB,SAAAY,GAAiB,kCAASA,GAAT,kBAA6BF,EAAMC,SAAU,IAC/HE,EAAiBJ,uBAAY,SAAAK,GAAWpB,GAAW,GAAOE,GAAa,GAAQO,EAAUW,EAAMC,OAAOJ,SAAW,IAEjHK,EAAgBP,uBAAY,SAAAQ,GAC9B,OAAO5B,EAAgBX,QAAO,SAAAwC,GAAI,OAAIA,EAAKC,SAASF,QACrD,CAAC5B,IAQE+B,EAAgBC,mBAAS,WAE7B,IAAMC,EAAqBC,OAAOC,KAAKzB,GAEvC,OAAO,SAAAkB,GAGL,GAAIlB,EAAc0B,eAAeR,GAAY,OAAOlB,EAAckB,GAGlE,IAAMS,EAAwBJ,EAAmBK,MAAK,SAAA9C,GAAI,OAAIoC,EAAQE,SAAStC,MAC/E,GAAI6C,EAAuB,CACzB,IACME,EADO7B,EAAc2B,GACNhD,QAAO,SAAAF,GAAG,OAAIA,EAAI2C,SAASF,MAChD,GAAIW,EAAQ1C,OAAS,EAAK,OAAO0C,EAGnC,OAAO,QAER,CAAC7B,IAEE8B,EAAgBpB,uBAAY,SAAAQ,GAChC,IAAMa,EAAsBV,EAAcH,GAC1C,OAAIc,MAAMC,QAAQF,GACTA,EAEmBd,EAAcC,KAGzC,CAACT,EAAmBQ,EAAeI,IA+BtC,OA7BAa,qBAAU,WAER,IAAMC,EAAYC,OAAOC,YAAW,WAClC,GAAsB,KAAlB3D,EAAO4D,OAAe,CACxB,IAAMC,EAAST,EAAcpD,GAC7BiB,GAAW,GACXc,EAAkB/B,EAAQ6D,GAC1BrE,EAASqE,EAAOC,KAAK,OAAOC,KAAKtC,QAEjCA,EAAgB,QAEjB,KAEH,OAAO,kBAAMiC,OAAOM,aAAaP,MAChC,CAACzD,IAEJwD,qBAAU,WACR,IAAMS,EAAKpD,EAASqD,QAChBD,aAAcE,SAAW9C,EAAqB4C,EAAGG,wBAAwBC,UAC5E,IAEHb,qBAAU,WACR,IAAM7B,EAAM,IAAI2C,KACVC,EAAYC,KAAKC,OAAQ9C,EAAF,OACvBc,EAAO7B,EAAgBA,EAAgBH,OAAS,EAAK8D,EAAY3D,EAAgBH,QACvFmB,EAAOD,GACPnC,EAASiD,GAAMsB,MAAK,SAAAvD,GAAG,OAAIA,EAAI,MAAIuD,KAAKjC,KACvC,CAAClB,IAGF,sBAAKvB,UAAU,SAAf,UACE,qBAAKA,UAAU,gBAAgBqF,IAAK7D,EAApC,SACE,qBAAKxB,UAAU,YAAf,SACE,uBAAO6C,MAAOlC,EAAQ2E,SAAUvC,EAAgBwC,YAAY,kCAGhE,sBAAKvF,UAAU,YAAf,UACE,qBAAKA,UAAU,sBAAsBwF,MAAO,CAACR,OAAQjD,KACnDF,GAAclB,GAAYsD,MAAMC,QAAQ/B,IAAyC,IAAxBA,EAAaf,OAAwE,KAAxD,qBAAKpB,UAAU,gBAAf,8GACvF2B,GAAWhB,EAAS,eAACb,EAAD,yCAAgB,uBAAhB,2BAAyC,KAE5D+B,GAAaS,EACX,sBAAKtC,UAAU,gBAAf,UACE,sGAAqBsC,EAAImD,cAAzB,YAA0CnD,EAAIoD,WAAa,EAA3D,YAAgEpD,EAAIqD,WAApE,OACCnD,EAAY/B,EAAU+B,GAAa,KACpC,uBACA,uNACA,+DAAQ,mBAAGoD,KAAK,yBAAyB3C,OAAO,SAAxC,uCACR,2MAAsC,mBAAG2C,KAAK,kDAAkD3C,OAAO,SAAjE,gEACtC,2JAAyB,mBAAG2C,KAAK,uCAAuC3C,OAAO,SAAtD,qDACzB,4BAAG,6EAAiB,mBAAG2C,KAAK,gCAAgC3C,OAAO,SAA/C,gCAEpB,MAEJtB,GAAWsC,MAAMC,QAAQ/B,GACzB,uBAAOnC,UAAU,gBAAjB,SACE,gCACGmC,EAAa0D,MAAM,EAAG,KAAK/E,KAAI,SAACJ,EAAKM,GACpC,OACE,6BAAgB,6BACbP,EAAUC,EAAKC,MADTK,UAOf,MACFW,GAAWsC,MAAMC,QAAQ/B,IAAyC,IAAxBA,EAAaf,OAAe,sHAAmC,MACzGO,GAAWsC,MAAMC,QAAQ/B,IAAiBA,EAAaf,OAAS,IAAM,mCAAQ,2DAAae,EAAaf,OAA1B,2EAAwD,uBAAM,0BAAkB,WCzHzJ0E,MApBf,WAAgB,IAAD,EACiCpE,mBAAS,MAD1C,mBACNH,EADM,KACWwE,EADX,KAab,OAVA5B,qBAAU,WACR6B,MAAM,yGACHtB,MAAK,SAAAuB,GAAQ,OAAIA,EAASC,UAE1BxB,MAAK,SAAAtE,GAAG,OAAIA,EAAIa,MAAM,SACtByD,MAAK,SAAAvD,GAAG,OAAIA,EAAI0E,MAAM,MAEtBnB,KAAKqB,KACP,IAGD,qBAAK/F,UAAU,MAAf,SACKiE,MAAMC,QAAQ3C,GAAmB,cAACD,EAAD,CAAQC,gBAAiBA,IAAsB,cAACrB,EAAD,OCT1EiG,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqB3B,MAAK,YAAkD,IAA/C4B,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,M","file":"static/js/main.a1f35ac7.chunk.js","sourcesContent":["import React from 'react';\n\n\nexport default function Spinner (props) {\n    return (\n      <div className=\"spinner\">\n        <div className=\"spinner__spinner\"></div>\n        {props.children ? <div className=\"spinner__text\">{props.children}</div> : ''}\n      </div>\n    );\n}\n","import Spinner from '../Spinner';\n\n\nexport default function Loading () {\n  return (\n    <div className=\"loading\">\n      <Spinner>Loading...<br />잠시만...</Spinner>\n    </div>\n  );\n}\n","import React, {useCallback, useEffect, useMemo, useRef, useState} from 'react';\nimport Spinner from '../Spinner';\nimport csvtojson from 'csvtojson';\n\n\nfunction keywordInRowFilter (keyword) {\n    return row => row.some(word => word.includes(keyword));\n}\n\nfunction parseCsv (csv) {\n    return csvtojson({noheader: true, output: 'csv'}).fromString(csv);\n}\n\nfunction renderRow (row, search = /$a/) {\n  return row.filter(Boolean).map((word, index) => {\n    const output = word.split(search).map((segment, index, arr) => {\n      if (arr.length - 1 === index) { return segment; }\n      return <React.Fragment key={index}>{segment}<div className=\"result__highlight\">{search}</div></React.Fragment>;\n    });\n    if (index === 0) { return (<code key={index} className=\"result__word result__word--chinese\">{output}</code>); }\n    return (<div key={index} className=\"result__word result__word--korean\">{index}. {output}</div>);\n});\n}\n\nexport default function Result (props) {\n  const {spreadsheetData} = props;\n  const inputRef = useRef();\n  const [loading, setLoading] = useState(false);\n  const [showIntro, setShowIntro] = useState(true);\n  const [placeholderHeight, setPlaceholderHeight] = useState(0);\n  const [searchHistory, setSearchHistory] = useState({});\n  const [searchResult, setSearchResult] = useState(null);\n  const [search, setSearch] = useState(\"\");\n  const [now, setNow] = useState(null);\n  const [wordOfDay, setWordOfDay] = useState(null);\n  const pushSearchHistory = useCallback((key, value) => setSearchHistory(prevSearchHistory => ({...prevSearchHistory, [key]: value})), []);\n  const onSearchChange = useCallback(event => { setLoading(true); setShowIntro(false); setSearch(event.target.value); }, []);\n\n  const generalSearch = useCallback(keyword => {\n      return spreadsheetData.filter(line => line.includes(keyword));\n  }, [spreadsheetData]);\n\n  /**\n   * Check if the current keyword exist in search history.\n   * @param {string} keyword - The searching keyword which is tried to be found\n   * in history.\n   * @returns {Array<string>|null}\n   */\n  const historySearch = useMemo (() => {\n    // Check if part of the keyword exists in the `searchHistory` map.\n    const searchHistoryWords = Object.keys(searchHistory);\n\n    return keyword => {\n\n      // Try to find the exact same keyword in history\n      if (searchHistory.hasOwnProperty(keyword)) { return searchHistory[keyword]; }\n\n      // Check if part of the current keyword exists in history, it still does reducing the searching time.\n      const potentialMatchKeyword = searchHistoryWords.find(word => keyword.includes(word));\n      if (potentialMatchKeyword) {\n        const rows = searchHistory[potentialMatchKeyword];\n        const results = rows.filter(row => row.includes(keyword));\n        if (results.length > 0) { return results; }\n      }\n\n      return null;\n    };\n  }, [searchHistory]);\n\n  const keywordSearch = useCallback(keyword => {\n    const historySearchedRows = historySearch(keyword);\n    if (Array.isArray(historySearchedRows)) {\n      return historySearchedRows;\n    } else {\n      const generalSearchRows = generalSearch(keyword);\n      return generalSearchRows;\n    }\n  }, [pushSearchHistory, generalSearch, historySearch]);\n\n  useEffect(() => {\n\n    const timeoutId = window.setTimeout(() => {\n      if (search.trim() !== \"\") {\n        const result = keywordSearch(search);\n        setLoading(false);\n        pushSearchHistory(search, result);\n        parseCsv(result.join(\"\\n\")).then(setSearchResult);\n      } else {\n        setSearchResult(null);\n      }\n    }, 500);\n\n    return () => window.clearTimeout(timeoutId);\n  }, [search]);\n\n  useEffect(() => {\n    const el = inputRef.current;\n    if (el instanceof Element) { setPlaceholderHeight(el.getBoundingClientRect().height); }\n  }, []);\n\n  useEffect(() => {\n    const now = new Date();\n    const todayDiff = Math.floor((+now) / (1000 * 60 * 60 * 24));\n    const line = spreadsheetData[spreadsheetData.length - 1 - (todayDiff % spreadsheetData.length)];\n    setNow(now);\n    parseCsv(line).then(arr => arr[0]).then(setWordOfDay);\n  }, [spreadsheetData]);\n\n  return (\n    <div className=\"result\">\n      <div className=\"result__input\" ref={inputRef}>\n        <div className=\"container\">\n          <input value={search} onChange={onSearchChange} placeholder=\"검색 搜尋\" />\n        </div>\n      </div>\n      <div className=\"container\">\n        <div className=\"result__placeholder\" style={{height: placeholderHeight}} />\n        {!showIntro && !search && (!Array.isArray(searchResult) || searchResult.length === 0) ? <div className=\"result__guide\">輸入搜索字詞，結果會喺呢度顯示。</div> : null}\n        {loading && search ? <Spinner>正在搜尋...<br />검색중...</Spinner> : null}\n        {\n          showIntro && now ? (\n            <div className=\"result__intro\">\n              <h5>每日單字 오늘의 단어 ({`${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`})</h5>\n              {wordOfDay ? renderRow(wordOfDay) : null}\n              <hr />\n              <p>呢個係一個依照由 이정윤 老師提供嘅字典所做嘅簡單廣東話韓文詞典</p>\n              <p>資料來源：<a href=\"https://bit.ly/3oRQHCe\" target=\"_blank\">https://bit.ly/3oRQHCe</a></p>\n              <p>如果有咩問題或者想參與更加多廣東話同韓文嘅交流請Facebook登入：<a href=\"https://www.facebook.com/groups/806902066095149\" target=\"_blank\">https://www.facebook.com/groups/806902066095149</a></p>\n              <p>如果想支持 이정윤 嘅話可以到以下呢個網址：<a href=\"https://www.buymeacoffee.com/ncOhltm\" target=\"_blank\">https://www.buymeacoffee.com/ncOhltm</a></p>\n              <p><small>應用程式製作 by <a href=\"https://github.com/winghimjns\" target=\"_blank\">winghimjns</a></small></p>\n            </div>\n          ) : null\n        }\n        {!loading && Array.isArray(searchResult) ? (\n          <table className=\"result__table\">\n            <tbody>\n              {searchResult.slice(0, 100).map((row, index) => {\n                return (\n                  <tr key={index}><td>\n                    {renderRow(row, search)}\n                  </td></tr>\n                );\n              })}\n            </tbody>\n          </table>\n        ) : null}\n        {!loading && Array.isArray(searchResult) && searchResult.length === 0 ? <center>沒有相關結果 결과가 없습니다</center> : null}\n        {!loading && Array.isArray(searchResult) && searchResult.length > 100 ? <center><code>{`總共有${searchResult.length}相關字詞，顯示首100個結果`}</code><br /><br /></center> : null}\n      </div>\n    </div>\n  );\n}\n","import {useEffect, useState} from 'react';\nimport Loading from './components/Loading';\nimport Result from './components/Result';\nimport csvtojson from 'csvtojson';\n\n\nfunction App() {\n  const [spreadsheetData, setSpreadsheetData] = useState(null);\n\n  useEffect(() => {\n    fetch('https://docs.google.com/spreadsheets/d/106i6RLyxQYh-jgEnPxZ3TX3C-VT3-k7vY-7gdfoLTyI/export?format=csv')\n      .then(response => response.text())\n      // .then(csv => csvtojson({noheader: true, output: 'csv'}).fromString(csv))\n      .then(csv => csv.split(\"\\n\"))\n      .then(arr => arr.slice(1))\n      // .then(data => data.map(row => row.filter(Boolean)))\n      .then(setSpreadsheetData);\n  }, []);\n\n  return (\n    <div className=\"app\">\n        {Array.isArray(spreadsheetData) ? <Result spreadsheetData={spreadsheetData} /> : <Loading />}\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}